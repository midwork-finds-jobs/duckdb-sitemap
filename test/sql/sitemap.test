# name: test/sql/sitemap.test
# description: Test sitemap extension
# group: [sitemap]

require sitemap

# Test that extension loads
statement ok
SELECT 1;

# Test sitemap_urls function exists with no arguments
statement error
SELECT * FROM sitemap_urls();
----
No function matches the given name and argument types

# Test sitemap_urls function exists with single string argument (will fail to find)
statement error
SELECT * FROM sitemap_urls('example.com');
----
Failed to find sitemap for

# Test sitemap_urls function exists with array argument (will fail to find)
statement error
SELECT * FROM sitemap_urls(['example.com', 'google.com']);
----
Failed to find sitemap for

# Test empty array (should throw error during bind)
statement error
SELECT * FROM sitemap_urls(CAST([] AS VARCHAR[]));
----
sitemap_urls() requires at least one URL

# Test sitemap_user_agent setting exists with default value
query I
SELECT current_setting('sitemap_user_agent');
----
DuckDB-Sitemap/1.0

# Test setting custom user agent
statement ok
SET sitemap_user_agent = 'TestBot/1.0';

# Verify custom user agent is set
query I
SELECT current_setting('sitemap_user_agent');
----
TestBot/1.0

# Test resetting user agent
statement ok
RESET sitemap_user_agent;

# Verify user agent is reset to default
query I
SELECT current_setting('sitemap_user_agent');
----
DuckDB-Sitemap/1.0
